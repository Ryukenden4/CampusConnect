<!DOCTYPE html>

<html lang="en">
    <head style="background-color: #f1f1f1;"> 
        <link rel="stylesheet" href="/collegeRegistration/css/registerStyle.css"> 
        <!-- basic -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta ne="viewport" content="width=device-width, initial-scale=1">
        <!-- mobile metas -->
        <meta ne="viewport" content="width=device-width, initial-scale=1">
        <meta ne="viewport" content="initial-scale=1, maximum-scale=1">
        <!-- site metas -->
        <title>College InfoCenter</title>
        <meta ne="keywords" content="">
        <meta ne="description" content="">
        <meta ne="author" content="">
        <!-- bootstrap css -->
        <link rel="stylesheet" type="text/css" href="/intermediate/css/bootstrap.min.css">
        <!-- style css -->
        <link rel="stylesheet" type="text/css" href="/intermediate/css/style.css">
        <link rel="stylesheet" type="text/css" href="/facilitiesBooking/assets/css/booking.css">
        <!-- Responsive-->
        <link rel="stylesheet" href="css/responsive.css">
        <!-- font css -->
        <link href="https://fonts.googleapis.com/css2?family=Sen:wght@400;700;800&display=swap" rel="stylesheet">
        <!-- Scrollbar Custom CSS -->
        <link rel="stylesheet" href="css/jquery.mCustomScrollbar.min.css">
        <!-- Tweaks for older IEs-->
        <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
        <!-- header -->
        <link rel="stylesheet" href="/homepage/assets/css/bootstrap.css">
        <link rel="stylesheet" href="/homepage/assets/css/maicons.css">
        <link rel="stylesheet" href="/homepage/assets/css/theme.css">

        
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css" type='text/css'>
        <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">

        <link rel="stylesheet" href="/collegeRegistration/admin/style.css">
    </head>

<body>
    <!--header-->
    <header style="background-color: white;">
        <nav class="navbar navbar-expand-lg navbar-light shadow-sm">
            <div class="container">
                <a class="navbar-brand" href="/intermediate/student.html"><span class="text-primary">College</span> InfoCenter</a>
    
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupport" aria-controls="navbarSupport" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
    
                <div class="collapse navbar-collapse" id="navbarSupport">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item ">
                            <a class="nav-link " style="font-size: 14px;" href="/intermediate/student.html">Home</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="registrationDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="font-size: 14px;" >
                                Registration
                            </a>
                            <div class="dropdown-menu" aria-labelledby="registrationDropdown">
                                <a class="dropdown-item" href="/collegeRegistration/html/collegeApply.html">College Registration</a>
                                <a class="dropdown-item" href="/progrRegistration/php/student.php">Progrme Registration</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="/facilitiesBooking/html/student.html" style="font-size: 14px;">Facilities Booking</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/customerSupport/html/customer.html" style="font-size: 14px;">Customer Support</a>
                        </li>
                        <!-- Add this within your navigation bar where you want the logout button to appear -->
                        <li class="nav-item">
                            <form action="/logout/logout.php" method="post">
                                <input type="submit" class="btn btn-primary ml-lg-3" style="background-color: #8b0000;" value="Logout">
                            </form>
                        </li>
                    </ul>
                </div> <!-- .navbar-collapse -->
            </div> <!-- .container -->
        </nav>
    </header>

    <!--content-->
    <div class="content">
    
        <main class="table">
            <div class="title">
                <h1 style="color: black;"><b>FACILITIES BOOKING</b></h1>
            </div>
        
        <section class="table__body">
            <table style="color: black;">
                
                <!-- User details -->
                <div class="user" id="userDetails">
                    <p id="studentId"></p>
                    <p id="fullName"></p>
                    <p id="college"></p>
                </div>
                
                <!-- Search form -->
                <div class="searchForm" >
                <div id="searchForm">
                    <label for="bookingDate">Date:</label>
                    <input type="date" id="bookingDate">
                
                    <label for="facilityType">Facility Type:</label>
                    <select id="facilityType">
                        <option value="meetingRoom">Meeting Room</option>
                        <option value="readingRoom">Reading Room</option>
                        <option value="gym">Gym</option>
                    </select>
                
                    <button onclick="searchSlots()">Search</button>
                </div>
                </div>
                
                <!-- Booking slots table -->
                <table id="bookingTable">
                    <!-- <thead>
                        <tr>
                            <th>Time</th>
                            <th>Availability</th>
                        </tr>
                    </thead> -->
                    <tbody id="bookingTableBody">
                        <!-- Table rows will be dynically added here -->
                    </tbody>
                </table>

    
                </tbody>
            </table>
        </section>

        <div class="input-field" style="padding-left: 40px;">
          
          <button type="button" onclick="goBack()" style="background-color: #8b0000; color: white;"  class="btn">Back</button>
        </div>
    </main>
    </div>
    

    <!-- footer 
    <div class="copyright_section">
        <div class="container">
            <p class="copyright_text">2023 All Rights Reserved. Design by <a href="#">Te Muizz</a></p>
        </div>
    </div>-->
    
</body>



<!--for header baru-->
<script src="/homepage/assets/js/jquery-3.5.1.min.js"></script>
<script src="/homepage/assets/js/bootstrap.bundle.min.js"></script>

<script src="script.js"></script>

<script>
function searchSlots() {
    // Get selected date and facility type
    var facilityType = document.getElementById("facilityType").value;
    console.log(facilityType);
    // Simulate availability for demonstration purposes
    var availability = {};
    
    // Generate time slots from 08:00 to 23:00
    for (var hour = 8; hour <= 23; hour++) {
        var startTime = ('0' + hour).slice(-2) + ':00';
        var endTime = ('0' + (hour + 1)).slice(-2) + ':00';
        
        // Simulate random availability (true or false)
        availability[startTime + ' - ' + endTime] = Math.random() < 0.7; // Adjust probability as needed
    }

    // Display the time slots in a table
    var table = '<tr><th>Time Slot</th><th>Action</th></tr>';
    for (var timeSlot in availability) {
        table += '<tr>';
        table += '<td>' + timeSlot + '</td>';
        if (availability[timeSlot]) {
            table += '<td><button onclick="bookSlot(\'' + timeSlot + '\')">Book</button></td>';
        } else {
            table += '<td>Not Available</td>';
        }
        table += '</tr>';
    }
    // Display the table
    document.getElementById("bookingTableBody").innerHTML = table;
}

function bookSlot(timeSlot) {
    // Extract start and end times from the selected time slot
    var [startTime, endTime] = timeSlot.split(' - ');

    // You can now use startTime and endTime for your booking logic
    alert('Booking confirmed for ' + startTime + ' - ' + endTime);
    // Also, you can proceed with sending the booking details to the server
    sendBookingToServer(startTime, endTime);
}

function sendBookingToServer(startTime, endTime) {
    var bookingDate = document.getElementById("bookingDate").value;
    var facilityType = document.getElementById("facilityType").value;

    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function () {
        if (xhr.readyState == 4 && xhr.status == 200) {
            var response = JSON.parse(xhr.responseText);
            if (response.success) {
                // Handle success, if needed
                console.log("Booking successful!");
            } else {
                // Handle error, if needed
                console.error(response.message);
            }
        }
    };

    xhr.open("POST", "booking.php", true);
    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");

    // Prepare data for the AJAX request
    var data = {
        bookingDate: bookingDate,
        facilities: facilityType,
        startTime: startTime,
        endTime: endTime
        // Add other data as needed
    };
    console.log(data);
    xhr.send(JSON.stringify(data));

}


    // Function to cancel booking
    function cancelBooking() {
        window.location.href = '/facilitiesBooking/html/student.html';
    }

    function goBack() {
        // Redirect to another HTML file
        window.location.href = '/facilitiesBooking/html/student.html'; 
    }

</script>

</html>